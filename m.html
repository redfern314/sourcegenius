<head>
  <title>SourceGenius</title>
</head>

<body>
    <div class="container">
      <div class="row">
        <div class="col-md-8 col-md-offset-2">
			<header>
				<div class="row">
				    <div class="col-md-12">
                        <ul class="actions left">
                            <li><a href="/"><span class="glyphicon glyphicon-home"></span></a></li>
                            <li><a href="/new"><span class="glyphicon glyphicon-plus"></span></a></li>
                        </ul>
				        <ul class="actions right">
				            <li class="user">
				            	{{> user }}
				            </li>
				        </ul>
                        <div class="clear"></div>
				    </div>
				</div>
			</header>

			<div class="wrapper">

			{{ renderPage }}
				
			</div>

          	<footer>
          	</footer>
      	</div>
    </div>
</body>


<template name="user">
    <div id="user">
        {{#if loggedIn }}
        	<a href="/github"><img id="octocat" src="/octocat.png" width="50" height="50"></a>
            <a href="#" class="sign-out"><img id="propic" alt="Click to sign out" height="50" width="50" src={{ URL }}></a>
        {{ else }}
            <a id="signin" href="#">sign in</a>
        {{/if }}
    </div>
</template>


<template name="home">
  {{#if loggedIn}}
    <div id="sources">
      {{#each userSources}}
        {{> sourceSynopsisTemplate }}
      {{/each}}
      {{#each sharedSources }}
        {{> sourceSynopsisTemplate }}
      {{/each }}
    </div>
  {{ else }}
    Not logged in!
  {{/if}}
</template>

<template name='sourceSynopsisTemplate'>
  <a href='/show/{{_id}}'><div>{{ prettifyTitle title }} by {{ authorName author }}</div></a>
</template>

<template name="github">
	<div class="row github">
    	<div class="col-md-12">
            <div class="text-container">
                <h3>Username</h3>
                <input id='username' width='100' value={{ username }}>
                <button id='submitusername'>Submit</button>
            </div>
    	</div>
    </div>
</template>

<template name='sharedSourceTemplate'>
  <a href='/show/{{_id}}'><div>{{ name }}</div></a>
</template>  

<template name="newFile">
    <div class="row newFile">
    	<div class="col-md-12">
            <input style='width:100%; margin-bottom:10px;' id='title' placeholder='Add a title'></input>
            <div class="text-container">
                <textarea width='500' class="language-any" id="newFileEntry" placeholder="Paste your code here"></textarea>
            </div>

            <div id='submit-new-file'><span class="glyphicon glyphicon-floppy-disk"></span></div>
    	</div>
    </div>
</template>

<template name="annotations">
    {{#each annos}}
      {{#isolate}}
        {{> annotation }}
      {{/isolate}}
    {{/each}}
    <div class="add">
        <textarea id='annotation' placeholder="Add a new comment"></textarea>
        <button id="annotateBtn" type="button" class="btn btn-default btn-block b">annotate</button>
    </div>
</template>

<template name="annotation">
    <div class="annotation">
        <div class="content row">
            <div class="col-md-12">
                {{#if editing this}}

                    <textarea data-id='{{ _id }}'>{{ text }}</textarea>
                {{ else }}
                    <p>{{ text  }}</p>
                {{/if}}
            </div>
        </div>
        <div class="author">
            <img src="http://placekitten.com/75/75" alt="">
            <h6 class="handle">{{ author.services.github.username }}</h6>
            <div class="cler"></div>
        </div>
      {{# if editing this }}
      {{ else }}
      {{#if canEdit this}}
          <a style='cursor:pointer;' class='edit' data-id='{{ _id }}'><span class="glyphicon glyphicon-edit" data-id='{{ _id }}'></span></a>
      {{/if}}
      {{/if}}
      <div class="clear"></div>
  </div>
</template>

<template name="show">
	<div class="row">
    <div class="col-md-12 code-container">
        <div class="snippet">
            {{#each splitLines}}
                <div class="{{this.cssClasses}}" data-id="{{this.index}}">
                    <pre class="language-{{this.language}}"><code class='language-{{this.language}}'>{{this.text}}</code></pre>
                </div>
            {{/each}}
        </div>
	</div>
    {{#isolate}}
      <div class='annotations' style='display:none;'>
        {{> annotations}}
      </div>
    {{/isolate}}
</template>

<template name="signIn">
	{{ loginButtons }}
</template>

